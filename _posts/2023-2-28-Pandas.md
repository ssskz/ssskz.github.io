---
title: Pandas
commentable: true
Edit: 2023-2-21
mathjax: true
mermaid: true
tags: python data-mining
categories: DS
description: This is a knowledge sharing about pandas on Data Mining course given by [Pr.Chen](https://shengquanchen.github.io/) sms, Nankai University, in 2023 spring semester.
--- 
# Pandasåº“ä¸‹è½½å’Œå®‰è£…

## Windowsç³»ç»Ÿå®‰è£…

ä½¿ç”¨ `pip` åŒ…ç®¡ç†å™¨å®‰è£… Pandasï¼Œæ˜¯æœ€ç®€å•çš„ä¸€ç§å®‰è£…æ–¹å¼ã€‚åœ¨ `CMD` å‘½ä»¤æç¤ºç¬¦ç•Œé¢è¡Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š


```markdown
pip install pandas
```

    Looking in indexes: https://pypi.tuna.tsinghua.edu.cn/simple
    Requirement already satisfied: pandas in /work/cabins/sccancer/anaconda3/envs/sccancer_py38/lib/python3.8/site-packages (1.5.2)
    Requirement already satisfied: python-dateutil>=2.8.1 in /work/cabins/sccancer/anaconda3/envs/sccancer_py38/lib/python3.8/site-packages (from pandas) (2.8.2)
    Requirement already satisfied: pytz>=2020.1 in /work/cabins/sccancer/anaconda3/envs/sccancer_py38/lib/python3.8/site-packages (from pandas) (2022.7)
    Requirement already satisfied: numpy>=1.20.3 in /work/cabins/sccancer/anaconda3/envs/sccancer_py38/lib/python3.8/site-packages (from pandas) (1.23.5)
    Requirement already satisfied: six>=1.5 in /work/cabins/sccancer/anaconda3/envs/sccancer_py38/lib/python3.8/site-packages (from python-dateutil>=2.8.1->pandas) (1.16.0)
    [33mWARNING: There was an error checking the latest version of pip.[0m[33m
    [0mNote: you may need to restart the kernel to use updated packages.


## MacOSç³»ç»Ÿå®‰è£…

å¯¹äº Mac ç”¨æˆ·è€Œè¨€ï¼ŒåŒæ ·å¯ä»¥ç›´æ¥ä½¿ç”¨ pip åŒ…ç®¡ç†å™¨æ¥å®‰è£…ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š


```python
pip install pandas
```

    Looking in indexes: https://pypi.tuna.tsinghua.edu.cn/simple
    Requirement already satisfied: pandas in /work/cabins/sccancer/anaconda3/envs/sccancer_py38/lib/python3.8/site-packages (1.5.2)
    Requirement already satisfied: python-dateutil>=2.8.1 in /work/cabins/sccancer/anaconda3/envs/sccancer_py38/lib/python3.8/site-packages (from pandas) (2.8.2)
    Requirement already satisfied: pytz>=2020.1 in /work/cabins/sccancer/anaconda3/envs/sccancer_py38/lib/python3.8/site-packages (from pandas) (2022.7)
    Requirement already satisfied: numpy>=1.20.3 in /work/cabins/sccancer/anaconda3/envs/sccancer_py38/lib/python3.8/site-packages (from pandas) (1.23.5)
    Requirement already satisfied: six>=1.5 in /work/cabins/sccancer/anaconda3/envs/sccancer_py38/lib/python3.8/site-packages (from python-dateutil>=2.8.1->pandas) (1.16.0)
    [33mWARNING: There was an error checking the latest version of pip.[0m[33m
    [0mNote: you may need to restart the kernel to use updated packages.


# Pandas Serieså…¥é—¨æ•™ç¨‹

## è®¤è¯†Serieså¯¹è±¡

Series ç»“æ„ï¼Œä¹Ÿç§° Series åºåˆ—ï¼Œæ˜¯ Pandas å¸¸ç”¨çš„æ•°æ®ç»“æ„ä¹‹ä¸€ï¼Œå®ƒæ˜¯ä¸€ç§ç±»ä¼¼äºä¸€ç»´æ•°ç»„çš„ç»“æ„ï¼Œç”±ä¸€ç»„æ•°æ®å€¼ï¼ˆvalueï¼‰å’Œä¸€ç»„æ ‡ç­¾ç»„æˆï¼Œå…¶ä¸­æ ‡ç­¾ä¸æ•°æ®å€¼ä¹‹é—´æ˜¯ä¸€ä¸€å¯¹åº”çš„å…³ç³»ã€‚

Series å¯ä»¥ä¿å­˜ä»»ä½•æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚æ•´æ•°ã€å­—ç¬¦ä¸²ã€æµ®ç‚¹æ•°ã€Python å¯¹è±¡ç­‰ï¼Œå®ƒçš„æ ‡ç­¾é»˜è®¤ä¸ºæ•´æ•°ï¼Œä» 0 å¼€å§‹ä¾æ¬¡é€’å¢ã€‚Series çš„ç»“æ„å›¾ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
![pandas_1](https://ssskz.github.io/about/pandas_1.png)

## åˆ›å»ºSerieså¯¹è±¡

Pandas ä½¿ç”¨ `Series()`  å‡½æ•°æ¥åˆ›å»º `Series` å¯¹è±¡


```python
import pandas as pd
s=pd.Series( data, index, dtype, copy)  
```

å‚æ•°è¯´æ˜å¦‚ä¸‹æ‰€ç¤ºï¼š  

- `data`ï¼šè¾“å…¥çš„æ•°æ®ï¼Œå¯ä»¥æ˜¯åˆ—è¡¨ã€å¸¸é‡ã€ndarray æ•°ç»„ç­‰ã€‚

- `index`ï¼šç´¢å¼•å€¼å¿…é¡»æ˜¯æƒŸä¸€çš„ï¼Œå¦‚æœæ²¡æœ‰ä¼ é€’ç´¢å¼•ï¼Œåˆ™é»˜è®¤ä¸º `np.arrange(n)`ï¼Œå³æŒ‰ç…§ä»0åˆ°n-1çš„å‡åºæ’åˆ—ã€‚  

- `dtype`ï¼šdtypeè¡¨ç¤ºæ•°æ®ç±»å‹ï¼Œå¦‚æœæ²¡æœ‰æä¾›ï¼Œåˆ™ä¼šè‡ªåŠ¨åˆ¤æ–­å¾—å‡ºã€‚  

- `copy`ï¼šè¡¨ç¤ºå¯¹ data è¿›è¡Œæ‹·è´ï¼Œé»˜è®¤ä¸º Falseã€‚  

###  åˆ›å»ºä¸€ä¸ªç©ºSerieså¯¹è±¡


```python
import pandas as pd
#è¾“å‡ºæ•°æ®ä¸ºç©º
s = pd.Series()
print(s)
```

    Series([], dtype: float64)


    /tmp/ipykernel_2884594/268069320.py:3: FutureWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.
      s = pd.Series()


### ndarrayåˆ›å»ºSerieså¯¹è±¡

å½“æˆ‘ä»¬æ²¡æœ‰ç»™serieså¢åŠ ç´¢å¼•æ—¶ï¼Œseriesçš„ç´¢å¼•ä¼šæŒ‰ç…§åˆ0åˆ°n-1çš„é¡ºåºè‡ªåŠ¨æ’åˆ—


```python
import numpy as np
data = np.array(['a','b','c','d'])
s = pd.Series(data)
print (s)
```

    0    a
    1    b
    2    c
    3    d
    dtype: object


æˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™ä¸€ä¸ªserieså¯¹è±¡å¢åŠ ç´¢å¼•


```python
import pandas as pd
import numpy as np
data = np.array(['a','b','c','d'])
#è‡ªå®šä¹‰ç´¢å¼•æ ‡ç­¾ï¼ˆå³æ˜¾ç¤ºç´¢å¼•ï¼‰
s = pd.Series(data,index=[100,101,102,103])
print(s)
```

    100    a
    101    b
    102    c
    103    d
    dtype: object


### dictåˆ›å»ºSerieså¯¹è±¡

æŠŠ dict ä½œä¸ºè¾“å…¥æ•°æ®ã€‚å¦‚æœæ²¡æœ‰ä¼ å…¥ç´¢å¼•æ—¶ä¼šæŒ‰ç…§å­—å…¸çš„é”®æ¥æ„é€ ç´¢å¼•  

å½“ä¼ é€’äº†ç´¢å¼•æ—¶éœ€è¦å°†ç´¢å¼•æ ‡ç­¾ä¸å­—å…¸ä¸­çš„å€¼ä¸€ä¸€å¯¹åº”

æ²¡æœ‰ä¼ é€’ç´¢å¼•æ—¶ï¼š

```python
import pandas as pd
import numpy as np
data = {'a' : 0., 'b' : 1., 'c' : 2.}
s = pd.Series(data)
print(s)
```

    a    0.0
    b    1.0
    c    2.0
    dtype: float64

ä¼ é€’äº†ç´¢å¼•æ—¶ï¼š

```python
import pandas as pd
import numpy as np
data = {'a' : 0., 'b' : 1., 'c' : 2.}
s = pd.Series(data,index=['b','c','d','a'])
print(s)
```

    b    1.0
    c    2.0
    d    NaN
    a    0.0
    dtype: float64


### æ ‡é‡åˆ›å»ºSerieså¯¹è±¡

å¦‚æœ data æ˜¯æ ‡é‡å€¼ï¼Œåˆ™å¿…é¡»æä¾›ç´¢å¼•ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

```python
import pandas as pd
import numpy as np
s = pd.Series(5, index=[0, 1, 2, 3])
print(s)
```

    0    5
    1    5
    2    5
    3    5
    dtype: int64


## è®¿é—®seriesæ•°æ®

è®¿é—® Series åºåˆ—ä¸­å…ƒç´ åˆ†ä¸ºä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯ä½ç½®ç´¢å¼•è®¿é—®ï¼›å¦ä¸€ç§æ˜¯ç´¢å¼•æ ‡ç­¾è®¿é—®

### ä½ç½®ç´¢å¼•è®¿é—®

æˆ‘ä»¬çŸ¥é“æ•°ç»„çš„ç´¢å¼•è®¡æ•°ä» 0 å¼€å§‹ï¼Œè¿™è¡¨ç¤ºç¬¬ä¸€ä¸ªå…ƒç´ å­˜å‚¨åœ¨ç¬¬ 0 ä¸ªç´¢å¼•ä½ç½®ä¸Šï¼Œä»¥æ­¤ç±»æ¨ï¼Œå°±å¯ä»¥è·å¾— Series åºåˆ—ä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚ä¸‹é¢çœ‹ä¸€ç»„ç®€å•çš„ç¤ºä¾‹ï¼š


```python
import pandas as pd
s = pd.Series([1,2,3,4,5],index = ['a','b','c','d','e'])
print(s[0])  #ä½ç½®ä¸‹æ ‡
```

    1


é€šè¿‡åˆ‡ç‰‡çš„æ–¹å¼è®¿é—® Series åºåˆ—ä¸­çš„æ•°æ®ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š


```python
print(s[:3])
```

    a    1
    b    2
    c    3
    dtype: int64



```python
print(s[-3:])
```

    c    3
    d    4
    e    5
    dtype: int64


### ç´¢å¼•æ ‡ç­¾è®¿é—®


Series ç±»ä¼¼äºå›ºå®šå¤§å°çš„ dictï¼ŒæŠŠ index ä¸­çš„ç´¢å¼•æ ‡ç­¾å½“åš keyï¼Œè€ŒæŠŠ Series åºåˆ—ä¸­çš„å…ƒç´ å€¼å½“åš valueï¼Œç„¶åé€šè¿‡ index ç´¢å¼•æ ‡ç­¾æ¥è®¿é—®æˆ–è€…ä¿®æ”¹å…ƒç´ å€¼ã€‚


```python
s = pd.Series([6,7,8,9,10],index = ['a','b','c','d','e'])
print(s['a'])
```

    6


ä½¿ç”¨ç´¢å¼•æ ‡ç­¾è®¿é—®å¤šä¸ªå…ƒç´ å€¼


```python
print(s[['a','c','d']])
```

    a    6
    c    8
    d    9
    dtype: int64


å¦‚æœä½¿ç”¨äº† index ä¸­ä¸åŒ…å«çš„æ ‡ç­¾ï¼Œåˆ™ä¼šè§¦å‘å¼‚å¸¸ï¼š


```python
s = pd.Series([6,7,8,9,10],index = ['a','b','c','d','e'])
#ä¸åŒ…å«få€¼
print(s['f'])
```


    ---------------------------------------------------------------------------

    KeyError                                  Traceback (most recent call last)

    File ~/anaconda3/envs/sccancer_py38/lib/python3.8/site-packages/pandas/core/indexes/base.py:3803, in Index.get_loc(self, key, method, tolerance)
       3802 try:
    -> 3803     return self._engine.get_loc(casted_key)
       3804 except KeyError as err:


    File ~/anaconda3/envs/sccancer_py38/lib/python3.8/site-packages/pandas/_libs/index.pyx:138, in pandas._libs.index.IndexEngine.get_loc()


    File ~/anaconda3/envs/sccancer_py38/lib/python3.8/site-packages/pandas/_libs/index.pyx:165, in pandas._libs.index.IndexEngine.get_loc()


    File pandas/_libs/hashtable_class_helper.pxi:5745, in pandas._libs.hashtable.PyObjectHashTable.get_item()


    File pandas/_libs/hashtable_class_helper.pxi:5753, in pandas._libs.hashtable.PyObjectHashTable.get_item()


    KeyError: 'f'

    
    The above exception was the direct cause of the following exception:


    KeyError                                  Traceback (most recent call last)

    Cell In[20], line 3
          1 s = pd.Series([6,7,8,9,10],index = ['a','b','c','d','e'])
          2 #ä¸åŒ…å«få€¼
    ----> 3 print(s['f'])


    File ~/anaconda3/envs/sccancer_py38/lib/python3.8/site-packages/pandas/core/series.py:981, in Series.__getitem__(self, key)
        978     return self._values[key]
        980 elif key_is_scalar:
    --> 981     return self._get_value(key)
        983 if is_hashable(key):
        984     # Otherwise index.get_value will raise InvalidIndexError
        985     try:
        986         # For labels that don't resolve as scalars like tuples and frozensets


    File ~/anaconda3/envs/sccancer_py38/lib/python3.8/site-packages/pandas/core/series.py:1089, in Series._get_value(self, label, takeable)
       1086     return self._values[label]
       1088 # Similar to Index.get_value, but we do not fall back to positional
    -> 1089 loc = self.index.get_loc(label)
       1090 return self.index._get_values_for_loc(self, loc, label)


    File ~/anaconda3/envs/sccancer_py38/lib/python3.8/site-packages/pandas/core/indexes/base.py:3805, in Index.get_loc(self, key, method, tolerance)
       3803     return self._engine.get_loc(casted_key)
       3804 except KeyError as err:
    -> 3805     raise KeyError(key) from err
       3806 except TypeError:
       3807     # If we have a listlike key, _check_indexing_error will raise
       3808     #  InvalidIndexError. Otherwise we fall through and re-raise
       3809     #  the TypeError.
       3810     self._check_indexing_error(key)


    KeyError: 'f'

## Serieså¸¸ç”¨å±æ€§

åœ¨ä¸‹è¡¨åˆ—å‡ºäº† Series å¯¹è±¡çš„å¸¸ç”¨å±æ€§ï¼š

| :--------------------------: | :---------------------: |
| åç§°   |  å±æ€§ |
| axes  | ä»¥åˆ—è¡¨çš„å½¢å¼è¿”å›æ‰€æœ‰è¡Œç´¢å¼•æ ‡ç­¾ |
| dtype | è¿”å›å¯¹è±¡çš„æ•°æ®ç±»å‹ |
| empty | è¿”å›ä¸€ä¸ªç©ºçš„ Series å¯¹è±¡ |
| ndim  | è¿”å›è¾“å…¥æ•°æ®çš„ç»´æ•°|
| size  | è¿”å›è¾“å…¥æ•°æ®çš„å…ƒç´ æ•°é‡ |
| values| ä»¥ndarray çš„å½¢å¼è¿”å› Series å¯¹è±¡ |
| index | è¿”å›ä¸€ä¸ªRangelndexå¯¹è±¡ï¼Œç”¨æ¥æè¿°ç´¢å¼•çš„å–å€¼èŒƒå›´ |


ç°åœ¨éšæœºåˆ›å»ºä¸€ä¸ªserieså¯¹è±¡ï¼Œç”¨æ¥æ¼”ç¤ºä¸Šè¿°å±æ€§


```python
import pandas as pd
import numpy as np
s = pd.Series(np.random.randn(5))
print(s)
```

    0   -1.144568
    1   -0.358787
    2    0.774467
    3   -1.673744
    4    0.148200
    dtype: float64


### axes


```python
print ("The axes are:")
print(s.axes)
```

    The axes are:
    [RangeIndex(start=0, stop=5, step=1)]


ä¸Šè¿°ç¤ºä¾‹çš„è¡Œç´¢å¼•æ ‡ç­¾æ˜¯ [0,1,2,3,4]ã€‚

###  dtype


```python
print ("The dtype is:")
print(s.dtype)
```

    The dtype is:
    float64


###  empty

è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œç”¨äºåˆ¤æ–­æ•°æ®å¯¹è±¡æ˜¯å¦ä¸ºç©ºã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š


```python
print("æ˜¯å¦ä¸ºç©ºå¯¹è±¡?")
print (s.empty)
print("æ˜¯å¦ä¸ºç©ºå¯¹è±¡?")
y =pd.Series()
print (y.empty)
```

    æ˜¯å¦ä¸ºç©ºå¯¹è±¡?
    False
    æ˜¯å¦ä¸ºç©ºå¯¹è±¡?
    True


    /tmp/ipykernel_2884594/3719198999.py:4: FutureWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.
      y =pd.Series()


### ndim

æŸ¥çœ‹åºåˆ—çš„ç»´æ•°ã€‚æ ¹æ®å®šä¹‰ï¼ŒSeries æ˜¯ä¸€ç»´æ•°æ®ç»“æ„ï¼Œå› æ­¤å®ƒå§‹ç»ˆè¿”å› 1ã€‚


```python
print (s)
print (s.ndim)
```

    0    1.136615
    1   -1.316431
    2    0.367285
    3    1.396443
    4    0.993101
    dtype: float64
    1


### values

ä»¥æ•°ç»„çš„å½¢å¼è¿”å› Series å¯¹è±¡ä¸­çš„æ•°æ®ã€‚


```python
print(s)
print("è¾“å‡ºseriesä¸­æ•°æ®")
print(s.values)
```

    0    1.136615
    1   -1.316431
    2    0.367285
    3    1.396443
    4    0.993101
    dtype: float64
    è¾“å‡ºseriesä¸­æ•°æ®
    [ 1.13661528 -1.31643087  0.36728474  1.39644329  0.99310053]


### index

è¯¥å±æ€§ç”¨æ¥æŸ¥çœ‹ Series ä¸­ç´¢å¼•çš„å–å€¼èŒƒå›´ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š


```python
#æ˜¾å¼ç´¢å¼•
s=pd.Series([1,2,5,8],index=['a','b','c','d'])
print(s.index)
#éšå¼ç´¢å¼•
s1=pd.Series([1,2,5,8])
print(s1.index)
```

    Index(['a', 'b', 'c', 'd'], dtype='object')
    RangeIndex(start=0, stop=4, step=1)


## Serieså¸¸ç”¨æ–¹æ³•

### head()&tail()æŸ¥çœ‹æ•°æ®

å¦‚æœæƒ³è¦æŸ¥çœ‹ Series çš„æŸä¸€éƒ¨åˆ†æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ head() æˆ–è€… tail() æ–¹æ³•ã€‚å…¶ä¸­ head() è¿”å›å‰ n è¡Œæ•°æ®ï¼Œé»˜è®¤æ˜¾ç¤ºå‰ 5 è¡Œæ•°æ®ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š


```python
s = pd.Series(np.random.randn(5))
print ("The original series is:")
print (s)
print("è¿”å›å‰ä¸‰è¡Œæ•°æ®")
print (s.head(3))
```

    The original series is:
    0   -0.834111
    1    1.024426
    2   -0.888609
    3    0.186547
    4    0.711474
    dtype: float64
    è¿”å›å‰ä¸‰è¡Œæ•°æ®
    0   -0.834111
    1    1.024426
    2   -0.888609
    dtype: float64


tail() è¿”å›çš„æ˜¯å n è¡Œæ•°æ®ï¼Œé»˜è®¤ä¸ºå 5 è¡Œã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š


```python
#åŸseries
print(s)
print("è¾“å‡ºåä¸¤è¡Œæ•°æ®")
print (s.tail(2))
```

    0   -0.834111
    1    1.024426
    2   -0.888609
    3    0.186547
    4    0.711474
    dtype: float64
    è¾“å‡ºåä¸¤è¡Œæ•°æ®
    3    0.186547
    4    0.711474
    dtype: float64


### isnull()&nonull()æ£€æµ‹ç¼ºå¤±å€¼

isnull() å’Œ nonull() ç”¨äºæ£€æµ‹ Series ä¸­çš„ç¼ºå¤±å€¼ã€‚æ‰€è°“ç¼ºå¤±å€¼ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯å€¼ä¸å­˜åœ¨ã€ä¸¢å¤±ã€ç¼ºå°‘ã€‚  
isnull()ï¼šå¦‚æœå€¼ç¼ºå¤±ï¼Œåˆ™è¿”å› Trueã€‚  
notnull()ï¼šå¦‚æœå€¼ç¼ºå¤±ï¼Œåˆ™è¿”å› Falseã€‚


```python
s=pd.Series([1,2,5,None])
print(pd.isnull(s))  #æ˜¯ç©ºå€¼è¿”å›True
print(pd.notnull(s)) #ç©ºå€¼è¿”å›False
```

    0    False
    1    False
    2    False
    3     True
    dtype: bool
    0     True
    1     True
    2     True
    3    False
    dtype: bool

# Pandas DataFrameå…¥é—¨æ•™ç¨‹

## è®¤è¯†DataFrameç»“æ„

DataFrame ä¸€ä¸ªè¡¨æ ¼å‹çš„æ•°æ®ç»“æ„ï¼Œæ—¢æœ‰è¡Œæ ‡ç­¾ï¼ˆindexï¼‰ï¼Œåˆæœ‰åˆ—æ ‡ç­¾ï¼ˆcolumnsï¼‰ï¼Œå®ƒä¹Ÿè¢«ç§°å¼‚æ„æ•°æ®è¡¨ï¼Œæ‰€è°“å¼‚æ„ï¼ŒæŒ‡çš„æ˜¯è¡¨æ ¼ä¸­æ¯åˆ—çš„æ•°æ®ç±»å‹å¯ä»¥ä¸åŒï¼Œæ¯”å¦‚å¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æ•´å‹æˆ–è€…æµ®ç‚¹å‹ç­‰ã€‚å…¶ç»“æ„å›¾ç¤ºæ„å›¾ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
![pandas_2](https://ssskz.github.io/about/pandas_2.png)

åŒ Series ä¸€æ ·ï¼ŒDataFrame è‡ªå¸¦è¡Œæ ‡ç­¾ç´¢å¼•ï¼Œé»˜è®¤ä¸ºâ€œéšå¼ç´¢å¼•â€å³ä» 0 å¼€å§‹ä¾æ¬¡é€’å¢ï¼Œè¡Œæ ‡ç­¾ä¸ DataFrame ä¸­çš„æ•°æ®é¡¹ä¸€ä¸€å¯¹åº”ã€‚ä¸Šè¿°è¡¨æ ¼çš„è¡Œæ ‡ç­¾ä» 0 åˆ° 4ï¼Œå…±è®°å½•äº† 4 æ¡æ•°æ®ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥ç”¨â€œæ˜¾å¼ç´¢å¼•â€çš„æ–¹å¼æ¥è®¾ç½®è¡Œæ ‡ç­¾ã€‚

## åˆ›å»ºDataFrameå¯¹è±¡


```python
import pandas as pd
pd.DataFrame( data, index, columns, dtype, copy)
```

| :--------------------------: | :---------------------: |
| å‚æ•°åç§° |  è¯´æ˜ |
| data  | è¾“å…¥çš„æ•°æ®ï¼Œå¯ä»¥æ˜¯ndarrayï¼Œseries, list, dictï¼Œ æ ‡é‡ä»¥åŠä¸€ä¸ª DataFrame |
| index | è¡Œæ ‡ç­¾ï¼Œå¦‚æœæ²¡æœ‰ä¼ é€’ index å€¼ï¼Œåˆ™é»˜è®¤è¡Œæ ‡ç­¾æ˜¯ `np.arange(n)`ï¼Œnä»£è¡¨data çš„å…ƒç´ ä¸ªæ•° |
| columns | åˆ—æ ‡ç­¾ï¼Œå¦‚æœæ²¡æœ‰ä¼ é€’ columns å€¼ï¼Œåˆ™é»˜è®¤åˆ—æ ‡ç­¾æ˜¯ `np.arange(n)` |
| dtype  | dtypeè¡¨ç¤ºæ¯ä¸€åˆ—çš„æ•°æ®ç±»å‹|
| copy  | é»˜è®¤ä¸º Falseï¼Œè¡¨ç¤ºå¤åˆ¶æ•°æ® data |

### åˆ›å»ºç©ºçš„DataFrameå¯¹è±¡

ä½¿ç”¨ä¸‹åˆ—æ–¹å¼åˆ›å»ºä¸€ä¸ªç©ºçš„ DataFrame


```python
df = pd.DataFrame()
print(df)
```

    Empty DataFrame
    Columns: []
    Index: []


åˆ—è¡¨åˆ›å»ºDataFameå¯¹è±¡

ç¤ºä¾‹ 1ï¼Œå•ä¸€åˆ—è¡¨åˆ›å»º DataFrameï¼š


```python
data = [1,2,3,4,5]
df = pd.DataFrame(data)
print(df)
```

       0
    0  1
    1  2
    2  3
    3  4
    4  5


ç¤ºä¾‹ 2ï¼Œä½¿ç”¨åµŒå¥—åˆ—è¡¨åˆ›å»º DataFrame å¯¹è±¡ï¼š


```python
data = [['Alex',10],['Bob',12],['Clarke',13]]
df = pd.DataFrame(data,columns=['Name','Age'])
print(df)
```

         Name  Age
    0    Alex   10
    1     Bob   12
    2  Clarke   13


ç¤ºä¾‹ 3ï¼ŒæŒ‡å®šæ•°å€¼å…ƒç´ çš„æ•°æ®ç±»å‹ä¸º floatï¼š


```python
data = [['Alex',10],['Bob',12],['Clarke',13]]
df = pd.DataFrame(data,columns=['Name','Age'],dtype=float)
print(df)
```

         Name   Age
    0    Alex  10.0
    1     Bob  12.0
    2  Clarke  13.0


    /tmp/ipykernel_2884594/3703379687.py:2: FutureWarning: Could not cast to float64, falling back to object. This behavior is deprecated. In a future version, when a dtype is passed to 'DataFrame', either all columns will be cast to that dtype, or a TypeError will be raised.
      df = pd.DataFrame(data,columns=['Name','Age'],dtype=float)


### å­—å…¸åµŒå¥—åˆ—è¡¨åˆ›å»º


```python
data = {'Name':['Tom', 'Jack', 'Steve', 'Ricky'],'Age':[28,34,29,42]}
df = pd.DataFrame(data)
print(df)
```

        Name  Age
    0    Tom   28
    1   Jack   34
    2  Steve   29
    3  Ricky   42


æ³¨æ„ï¼šè¿™é‡Œä½¿ç”¨äº†é»˜è®¤è¡Œæ ‡ç­¾ï¼Œä¹Ÿå°±æ˜¯ range(n)ã€‚å®ƒç”Ÿæˆäº† 0,1,2,3ï¼Œå¹¶åˆ†åˆ«å¯¹åº”äº†åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ å€¼ã€‚

ç°åœ¨ç»™ä¸Šè¿°ç¤ºä¾‹æ·»åŠ è‡ªå®šä¹‰çš„è¡Œæ ‡ç­¾ï¼š


```python
data = {'Name':['Tom', 'Jack', 'Steve', 'Ricky'],'Age':[28,34,29,42]}
df = pd.DataFrame(data, index=['rank1','rank2','rank3','rank4'])
print(df)
```

            Name  Age
    rank1    Tom   28
    rank2   Jack   34
    rank3  Steve   29
    rank4  Ricky   42


## åˆ—è¡¨åµŒå¥—å­—å…¸åˆ›å»ºDataFrameå¯¹è±¡


```python
data = [{'a': 1, 'b': 2},{'a': 5, 'b': 10, 'c': 20}]
df = pd.DataFrame(data, index=['first', 'second'])
print(df)
```

            a   b     c
    first   1   2   NaN
    second  5  10  20.0


### Seriesåˆ›å»ºDataFrameå¯¹è±¡

å¯ä»¥ä¼ é€’ä¸€ä¸ªå­—å…¸å½¢å¼çš„ Seriesï¼Œä»è€Œåˆ›å»ºä¸€ä¸ª DataFrame å¯¹è±¡ï¼Œå…¶è¾“å‡ºç»“æœçš„è¡Œç´¢å¼•æ˜¯æ‰€æœ‰ index çš„å¹¶é›†


```python
d = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']),
   'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])}
df = pd.DataFrame(d)
print(df)
```

       one  two
    a  1.0    1
    b  2.0    2
    c  3.0    3
    d  NaN    4


## åˆ—ç´¢å¼•æ“ä½œDataFrame

###  åˆ—ç´¢å¼•é€‰å–æ•°æ®åˆ—


```python
d = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']),
   'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])}
df = pd.DataFrame(d)
print(df ['one'])
```

    a    1.0
    b    2.0
    c    3.0
    d    NaN
    Name: one, dtype: float64


### åˆ—ç´¢å¼•æ·»åŠ æ•°æ®åˆ—

ä½¿ç”¨ columns åˆ—ç´¢å¼•è¡¨æ ‡ç­¾å¯ä»¥å®ç°æ·»åŠ æ–°çš„æ•°æ®åˆ—


```python
d = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']),
   'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])}
df = pd.DataFrame(d)
print("ä½¿ç”¨df['åˆ—']=å€¼ï¼Œæ’å…¥æ–°çš„æ•°æ®åˆ—")
df['three']=pd.Series([10,20,30],index=['a','b','c'])
print(df)
print("å°†å·²ç»å­˜åœ¨çš„æ•°æ®åˆ—åšç›¸åŠ è¿ç®—")
df['four']=df['one']+df['three']
print(df)
```

    ä½¿ç”¨df['åˆ—']=å€¼ï¼Œæ’å…¥æ–°çš„æ•°æ®åˆ—
       one  two  three
    a  1.0    1   10.0
    b  2.0    2   20.0
    c  3.0    3   30.0
    d  NaN    4    NaN
    å°†å·²ç»å­˜åœ¨çš„æ•°æ®åˆ—åšç›¸åŠ è¿ç®—
       one  two  three  four
    a  1.0    1   10.0  11.0
    b  2.0    2   20.0  22.0
    c  3.0    3   30.0  33.0
    d  NaN    4    NaN   NaN


ä½¿ç”¨ **insert()** æ–¹æ³•æ’å…¥æ–°çš„åˆ—


```python
info=[['Jack',18],['Helen',19],['John',17]]
df=pd.DataFrame(info,columns=['name','age'])
print(df)
#æ³¨æ„æ˜¯columnå‚æ•°
#æ•°å€¼1ä»£è¡¨æ’å…¥åˆ°columnsåˆ—è¡¨çš„ç´¢å¼•ä½ç½®
df.insert(1,column='score',value=[91,90,75])
print(df)
```

        name  age
    0   Jack   18
    1  Helen   19
    2   John   17
        name  score  age
    0   Jack     91   18
    1  Helen     90   19
    2   John     75   17


### åˆ—ç´¢å¼•åˆ é™¤æ•°æ®åˆ—

é€šè¿‡**del** å’Œ **pop()** éƒ½èƒ½å¤Ÿåˆ é™¤ DataFrame ä¸­çš„æ•°æ®åˆ—


```python
d = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']),
   'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd']),
   'three' : pd.Series([10,20,30], index=['a','b','c'])}
df = pd.DataFrame(d)
print ("Our dataframe is:")
print(df)
#ä½¿ç”¨delåˆ é™¤
del df['one']
print(df)
#ä½¿ç”¨popæ–¹æ³•åˆ é™¤
df.pop('two')
print (df)
```

    Our dataframe is:
       one  two  three
    a  1.0    1   10.0
    b  2.0    2   20.0
    c  3.0    3   30.0
    d  NaN    4    NaN
       two  three
    a    1   10.0
    b    2   20.0
    c    3   30.0
    d    4    NaN
       three
    a   10.0
    b   20.0
    c   30.0
    d    NaN


## è¡Œç´¢å¼•æ“ä½œDataFrame

### æ ‡ç­¾ç´¢å¼•é€‰å–

å¯ä»¥å°†è¡Œæ ‡ç­¾ä¼ é€’ç»™ loc å‡½æ•°ï¼Œæ¥é€‰å–æ•°æ®ã€‚


```python
d = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']),
   'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])}
df = pd.DataFrame(d)
print(df)
print("locå‡½æ•°")
print(df.loc['b'])
```

       one  two
    a  1.0    1
    b  2.0    2
    c  3.0    3
    d  NaN    4
    locå‡½æ•°
    one    2.0
    two    2.0
    Name: b, dtype: float64


### æ•´æ•°ç´¢å¼•é€‰å–

é€šè¿‡å°†æ•°æ®è¡Œæ‰€åœ¨çš„ç´¢å¼•ä½ç½®ä¼ é€’ç»™ iloc å‡½æ•°ï¼Œä¹Ÿå¯ä»¥å®ç°æ•°æ®è¡Œé€‰å–


```python
d = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']),
   'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])}
df = pd.DataFrame(d)
print (df.iloc[2])
```

    one    3.0
    two    3.0
    Name: c, dtype: float64


### åˆ‡ç‰‡æ“ä½œå¤šè¡Œé€‰å–


```python
d = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']),
   'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])}
df = pd.DataFrame(d)
#å·¦é—­å³å¼€
print(df[2:4])
```

       one  two
    c  3.0    3
    d  NaN    4


### æ·»åŠ æ•°æ®è¡Œ

ä½¿ç”¨ **append()** å‡½æ•°ï¼Œå¯ä»¥å°†æ–°çš„æ•°æ®è¡Œæ·»åŠ åˆ° DataFrame ä¸­ï¼Œè¯¥å‡½æ•°ä¼šåœ¨è¡Œæœ«è¿½åŠ æ•°æ®è¡Œã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š


```python
df = pd.DataFrame([[1, 2], [3, 4]], columns = ['a','b'])
df2 = pd.DataFrame([[5, 6], [7, 8]], columns = ['a','b'])
#åœ¨è¡Œæœ«è¿½åŠ æ–°æ•°æ®è¡Œ
df = df.append(df2)
print(df)
```

       a  b
    0  1  2
    1  3  4
    0  5  6
    1  7  8


    /tmp/ipykernel_2884594/1922837991.py:4: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      df = df.append(df2)


### åˆ é™¤æ•°æ®è¡Œ

ä½¿ç”¨è¡Œç´¢å¼•æ ‡ç­¾ï¼Œåˆ©ç”¨**drop**å‡½æ•°ä» DataFrame ä¸­åˆ é™¤æŸä¸€è¡Œæ•°æ®ã€‚å¦‚æœç´¢å¼•æ ‡ç­¾å­˜åœ¨é‡å¤ï¼Œé‚£ä¹ˆå®ƒä»¬å°†è¢«ä¸€èµ·åˆ é™¤


```python
df = pd.DataFrame([[1, 2], [3, 4]], columns = ['a','b'])
df2 = pd.DataFrame([[5, 6], [7, 8]], columns = ['a','b'])
df = df.append(df2)
print(df)
print("æ³¨æ„æ­¤å¤„è°ƒç”¨äº†drop()æ–¹æ³•")
df = df.drop(0)
print (df)
```

       a  b
    0  1  2
    1  3  4
    0  5  6
    1  7  8
    æ³¨æ„æ­¤å¤„è°ƒç”¨äº†drop()æ–¹æ³•
       a  b
    1  3  4
    1  7  8


    /tmp/ipykernel_2884594/2606420068.py:3: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
      df = df.append(df2)


## å¸¸ç”¨å±æ€§å’Œæ–¹æ³•æ±‡æ€»

DataFrame çš„å±æ€§å’Œæ–¹æ³•ï¼Œä¸ Series ç›¸å·®æ— å‡ ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

| :--------------------------: | :---------------------: |
| åç§° |  å±æ€§&æ–¹æ³•æè¿° |
| T  | è¡Œå’Œåˆ—è½¬ç½® |
| axes | è¿”å›ä¸€ä¸ªä»…ä»¥è¡Œè½´æ ‡ç­¾å’Œåˆ—è½´æ ‡ç­¾ä¸ºæˆå‘˜çš„åˆ—è¡¨ |
| dtypes | è¿”å›æ¯åˆ—æ•°æ®çš„æ•°æ®ç±»å‹ |
| empty  | DataFrameä¸­æ²¡æœ‰æ•°æ®æˆ–è€…ä»»æ„åæ ‡è½´çš„é•¿åº¦ä¸º0ï¼Œåˆ™è¿”å›True|
| ndim  | è½´çš„æ•°é‡ï¼Œä¹ŸæŒ‡æ•°ç»„çš„ç»´æ•° |
| shape  |è¿”å›ä¸€ä¸ªå…ƒç»„ï¼Œè¡¨ç¤ºäº† DataFrame ç»´åº¦|
| size  |DataFrameä¸­çš„å…ƒç´ æ•°é‡|
| values  |ä½¿ç”¨numpy æ•°ç»„è¡¨ç¤º DataFrame ä¸­çš„å…ƒç´ å€¼|
| head()  | è¿”å›å‰nè¡Œæ•°æ®|
| tail()  | è¿”å›ånè¡Œæ•°æ®|
| shift()  | å°†è¡Œæˆ–åˆ—ç§»åŠ¨æŒ‡å®šçš„æ­¥å¹…é•¿åº¦|

### Tï¼ˆTransposeï¼‰è½¬ç½®

è¿”å› DataFrame çš„è½¬ç½®ï¼Œä¹Ÿå°±æ˜¯æŠŠè¡Œå’Œåˆ—è¿›è¡Œäº¤æ¢ã€‚


```python
d = {'Name':pd.Series(['cè¯­è¨€ä¸­æ–‡ç½‘','ç¼–ç¨‹å¸®',"ç™¾åº¦",'360æœç´¢','è°·æ­Œ','å¾®å­¦è‹‘','Bingæœç´¢']),
   'years':pd.Series([5,6,15,28,3,19,23]),
   'Rating':pd.Series([4.23,3.24,3.98,2.56,3.20,4.6,3.8])}
#æ„å»ºDataFrame
df = pd.DataFrame(d)
print(df)


print("è¾“å‡ºDataFrameçš„è½¬ç½®")
print(df.T)
```

         Name  years  Rating
    0  cè¯­è¨€ä¸­æ–‡ç½‘      5    4.23
    1     ç¼–ç¨‹å¸®      6    3.24
    2      ç™¾åº¦     15    3.98
    3   360æœç´¢     28    2.56
    4      è°·æ­Œ      3    3.20
    5     å¾®å­¦è‹‘     19    4.60
    6  Bingæœç´¢     23    3.80
    è¾“å‡ºDataFrameçš„è½¬ç½®
                 0     1     2      3    4    5       6
    Name    cè¯­è¨€ä¸­æ–‡ç½‘   ç¼–ç¨‹å¸®    ç™¾åº¦  360æœç´¢   è°·æ­Œ  å¾®å­¦è‹‘  Bingæœç´¢
    years        5     6    15     28    3   19      23
    Rating    4.23  3.24  3.98   2.56  3.2  4.6     3.8


 axesã€dtypesã€ emptyã€ndimã€ valuesã€head()&tail()æŸ¥çœ‹æ•°æ®ã€‚è¿™äº›å‡½æ•°ä¸seriesçš„ä½œç”¨ç±»ä¼¼ï¼Œåœ¨è¿™é‡Œå°±ä¸å¤šåšä»‹ç»äº†ã€‚

### shape

è¿”å›ä¸€ä¸ªä»£è¡¨ DataFrame ç»´åº¦çš„å…ƒç»„ã€‚è¿”å›å€¼å…ƒç»„ (a,b)ï¼Œå…¶ä¸­ a è¡¨ç¤ºè¡Œæ•°ï¼Œb è¡¨ç¤ºåˆ—æ•°ã€‚


```python
d = {'Name':pd.Series(['cè¯­è¨€ä¸­æ–‡ç½‘','ç¼–ç¨‹å¸®',"ç™¾åº¦",'360æœç´¢','è°·æ­Œ','å¾®å­¦è‹‘','Bingæœç´¢']),
   'years':pd.Series([5,6,15,28,3,19,23]),
   'Rating':pd.Series([4.23,3.24,3.98,2.56,3.20,4.6,3.8])}
#æ„å»ºDataFrame
df = pd.DataFrame(d)
#DataFrameçš„å½¢çŠ¶
print(df.shape)

```

    (7, 3)


### size

è¿”å› DataFrame ä¸­çš„å…ƒç´ æ•°é‡ã€‚


```python
print(df.size)
```

    21


# Python Pandasæè¿°æ€§ç»Ÿè®¡

ä¸‹åˆ—è¡¨æ ¼å¯¹ Pandas å¸¸ç”¨çš„ç»Ÿè®¡å­¦å‡½æ•°åšäº†ç®€å•çš„æ€»ç»“ï¼š

| :--------------------------: | :---------------------: |
| å‡½æ•°åç§° |  æè¿°è¯´æ˜ |
| count  | ç»Ÿè®¡æŸä¸ªéç©ºå€¼çš„æ•°é‡ |
| sum() | æ±‚å’Œ |
| mean() | æ±‚å‡å€¼ |
| median()  | æ±‚ä¸­ä½æ•° |
| mode()  | æ±‚ä¼—æ•° |
| std()  |æ±‚æ ‡å‡†å·®|
| min()  |æ±‚æœ€å°å€¼|
| max()  |æ±‚æœ€å¤§å€¼|
| abs()  | æ±‚ç»å¯¹å€¼|
| prod() | æ±‚æ‰€æœ‰æ•°å€¼çš„ä¹˜ç§¯|
| cumsum()  |  è®¡ç®—ç´¯è®¡å’Œï¼Œaxis=0ï¼ŒæŒ‰ç…§è¡Œç´¯åŠ ï¼›axis=1ï¼ŒæŒ‰ç…§åˆ—ç´¯åŠ |
| cumprod()  | è®¡ç®—ç´¯è®¡ç§¯ï¼Œaxis=0ï¼ŒæŒ‰ç…§è¡Œç´¯ç§¯ï¼›axis=1ï¼ŒæŒ‰ç…§åˆ—ç´¯ç§¯|
| corr()  | è®¡ç®—æ•°åˆ—æˆ–å˜é‡ä¹‹é—´çš„ç›¸å…³ç³»æ•°ï¼Œå–å€¼-1åˆ°1ï¼Œå€¼è¶Šå¤§è¡¨ç¤ºå…³è”æ€§è¶Šå¼º|


åœ¨ DataFrame ä¸­ï¼Œä½¿ç”¨èšåˆç±»æ–¹æ³•æ—¶éœ€è¦æŒ‡å®šè½´(axis)å‚æ•°ã€‚ä¸‹é¢ä»‹ç»ä¸¤ç§ä¼ å‚æ–¹å¼ï¼š  
å¯¹è¡Œæ“ä½œï¼Œé»˜è®¤ä½¿ç”¨ axis=0 æˆ–è€…ä½¿ç”¨ "index"ï¼›  
å¯¹åˆ—æ“ä½œï¼Œé»˜è®¤ä½¿ç”¨ axis=1 æˆ–è€…ä½¿ç”¨ "columns"ã€‚
![pandas_3](https://ssskz.github.io/about/pandas_3.png)
ä»å›¾å¯ä»¥çœ‹å‡ºï¼Œaxis=0 è¡¨ç¤ºæŒ‰å‚ç›´æ–¹å‘è¿›è¡Œè®¡ç®—ï¼Œè€Œ axis=1 åˆ™è¡¨ç¤ºæŒ‰æ°´å¹³æ–¹å‘ã€‚


## sum()æ±‚å’Œ

åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿”å› axis=0 çš„æ‰€æœ‰å€¼çš„å’Œã€‚


```python
#åˆ›å»ºå­—å…¸å‹seriesç»“æ„
d = {'Name':pd.Series(['å°æ˜','å°äº®','å°çº¢','å°å','è€èµµ','å°æ›¹','å°é™ˆ',
   'è€æ','è€ç‹','å°å†¯','å°ä½•','è€å¼ ']),
   'Age':pd.Series([25,26,25,23,30,29,23,34,40,30,51,46]),
   'Rating':pd.Series([4.23,3.24,3.98,2.56,3.20,4.6,3.8,3.78,2.98,4.80,4.10,3.65])
}
df = pd.DataFrame(d)
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
      <th>Rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>å°æ˜</td>
      <td>25</td>
      <td>4.23</td>
    </tr>
    <tr>
      <th>1</th>
      <td>å°äº®</td>
      <td>26</td>
      <td>3.24</td>
    </tr>
    <tr>
      <th>2</th>
      <td>å°çº¢</td>
      <td>25</td>
      <td>3.98</td>
    </tr>
    <tr>
      <th>3</th>
      <td>å°å</td>
      <td>23</td>
      <td>2.56</td>
    </tr>
    <tr>
      <th>4</th>
      <td>è€èµµ</td>
      <td>30</td>
      <td>3.20</td>
    </tr>
    <tr>
      <th>5</th>
      <td>å°æ›¹</td>
      <td>29</td>
      <td>4.60</td>
    </tr>
    <tr>
      <th>6</th>
      <td>å°é™ˆ</td>
      <td>23</td>
      <td>3.80</td>
    </tr>
    <tr>
      <th>7</th>
      <td>è€æ</td>
      <td>34</td>
      <td>3.78</td>
    </tr>
    <tr>
      <th>8</th>
      <td>è€ç‹</td>
      <td>40</td>
      <td>2.98</td>
    </tr>
    <tr>
      <th>9</th>
      <td>å°å†¯</td>
      <td>30</td>
      <td>4.80</td>
    </tr>
    <tr>
      <th>10</th>
      <td>å°ä½•</td>
      <td>51</td>
      <td>4.10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>è€å¼ </td>
      <td>46</td>
      <td>3.65</td>
    </tr>
  </tbody>
</table>
</div>




```python
#é»˜è®¤axis=0æˆ–è€…ä½¿ç”¨sum("index")
print(df.sum())
```

    Name      å°æ˜å°äº®å°çº¢å°åè€èµµå°æ›¹å°é™ˆè€æè€ç‹å°å†¯å°ä½•è€å¼ 
    Age                            382
    Rating                       44.92
    dtype: object


æ³¨æ„ï¼šsum() å’Œ cumsum() å‡½æ•°å¯ä»¥åŒæ—¶å¤„ç†æ•°å­—å’Œå­—ç¬¦ä¸²æ•°æ®ã€‚ä¸‹é¢å†çœ‹ä¸€ä¸‹ axis=1 çš„æƒ…å†µï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š


```python
print(df.sum(axis=1))
```

    0     29.23
    1     29.24
    2     28.98
    3     25.56
    4     33.20
    5     33.60
    6     26.80
    7     37.78
    8     42.98
    9     34.80
    10    55.10
    11    49.65
    dtype: float64


    /tmp/ipykernel_2884594/166068483.py:1: FutureWarning: Dropping of nuisance columns in DataFrame reductions (with 'numeric_only=None') is deprecated; in a future version this will raise TypeError.  Select only valid columns before calling the reduction.
      print(df.sum(axis=1))


## mean()æ±‚å‡å€¼


```python
print(df.mean())
```

    Age       31.833333
    Rating     3.743333
    dtype: float64


    /tmp/ipykernel_2884594/2807316344.py:1: FutureWarning: The default value of numeric_only in DataFrame.mean is deprecated. In a future version, it will default to False. In addition, specifying 'numeric_only=None' is deprecated. Select only valid columns or specify the value of numeric_only to silence this warning.
      print(df.mean())


## std()æ±‚æ ‡å‡†å·®


```python
print(df.std())
```

    Age       9.232682
    Rating    0.661628
    dtype: float64


    /tmp/ipykernel_2884594/2597523637.py:1: FutureWarning: The default value of numeric_only in DataFrame.std is deprecated. In a future version, it will default to False. In addition, specifying 'numeric_only=None' is deprecated. Select only valid columns or specify the value of numeric_only to silence this warning.
      print(df.std())


## describeæ•°æ®æ±‡æ€»æè¿°

describe() å‡½æ•°æ˜¾ç¤ºä¸ DataFrame æ•°æ®åˆ—ç›¸å…³çš„ç»Ÿè®¡ä¿¡æ¯æ‘˜è¦ã€‚


```python
print(df.describe())
```

                 Age     Rating
    count  12.000000  12.000000
    mean   31.833333   3.743333
    std     9.232682   0.661628
    min    23.000000   2.560000
    25%    25.000000   3.230000
    50%    29.500000   3.790000
    75%    35.500000   4.132500
    max    51.000000   4.800000


describe() å‡½æ•°è¾“å‡ºäº†å¹³å‡å€¼ã€std å’Œ IQR å€¼(å››åˆ†ä½è·)ç­‰ä¸€ç³»åˆ—ç»Ÿè®¡ä¿¡æ¯ã€‚

# Pandas reindexé‡ç½®ç´¢å¼•

é‡ç½®ç´¢å¼•ï¼ˆreindexï¼‰å¯ä»¥æ›´æ”¹åŸ DataFrame çš„è¡Œæ ‡ç­¾æˆ–åˆ—æ ‡ç­¾ï¼Œå¹¶ä½¿æ›´æ”¹åçš„è¡Œã€åˆ—æ ‡ç­¾ä¸ DataFrame ä¸­çš„æ•°æ®é€ä¸€åŒ¹é…ã€‚é€šè¿‡é‡ç½®ç´¢å¼•æ“ä½œï¼Œæ‚¨å¯ä»¥å®Œæˆå¯¹ç°æœ‰æ•°æ®çš„**é‡æ–°æ’åº**ã€‚å¦‚æœé‡ç½®çš„ç´¢å¼•æ ‡ç­¾åœ¨åŸ DataFrame ä¸­ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆè¯¥æ ‡ç­¾å¯¹åº”çš„å…ƒç´ å€¼å°†å…¨éƒ¨å¡«å……ä¸º NaNã€‚

## é‡ç½®è¡Œåˆ—æ ‡ç­¾


```python
N=20
#ä¸‹é¢æˆ‘ä»¬ä¸å»è€ƒè™‘æ¯ä¸ªå‡½æ•°çš„å…·ä½“æ„æ€ï¼Œåªå»å…³æ³¨ç»“æœ
df = pd.DataFrame({
   'A': pd.date_range(start='2016-01-01',periods=N,freq='D'),
   'x': np.linspace(0,stop=N-1,num=N),
   'y': np.random.rand(N),
   'C': np.random.choice(['Low','Medium','High'],N).tolist(),
   'D': np.random.normal(100, 10, size=(N)).tolist()
})

df 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>x</th>
      <th>y</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016-01-01</td>
      <td>0.0</td>
      <td>0.786869</td>
      <td>Low</td>
      <td>93.234759</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016-01-02</td>
      <td>1.0</td>
      <td>0.627477</td>
      <td>High</td>
      <td>95.796426</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2016-01-03</td>
      <td>2.0</td>
      <td>0.339050</td>
      <td>Low</td>
      <td>109.331537</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2016-01-04</td>
      <td>3.0</td>
      <td>0.574832</td>
      <td>Low</td>
      <td>104.063895</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2016-01-05</td>
      <td>4.0</td>
      <td>0.424389</td>
      <td>Medium</td>
      <td>110.734752</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2016-01-06</td>
      <td>5.0</td>
      <td>0.713037</td>
      <td>High</td>
      <td>112.271701</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2016-01-07</td>
      <td>6.0</td>
      <td>0.958037</td>
      <td>Medium</td>
      <td>111.626911</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2016-01-08</td>
      <td>7.0</td>
      <td>0.988429</td>
      <td>Medium</td>
      <td>85.860609</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2016-01-09</td>
      <td>8.0</td>
      <td>0.723241</td>
      <td>Medium</td>
      <td>104.987049</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2016-01-10</td>
      <td>9.0</td>
      <td>0.458040</td>
      <td>High</td>
      <td>102.100842</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2016-01-11</td>
      <td>10.0</td>
      <td>0.396474</td>
      <td>High</td>
      <td>106.750159</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2016-01-12</td>
      <td>11.0</td>
      <td>0.815082</td>
      <td>Low</td>
      <td>85.520715</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2016-01-13</td>
      <td>12.0</td>
      <td>0.449427</td>
      <td>High</td>
      <td>99.417791</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2016-01-14</td>
      <td>13.0</td>
      <td>0.400966</td>
      <td>Medium</td>
      <td>96.604479</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2016-01-15</td>
      <td>14.0</td>
      <td>0.192624</td>
      <td>High</td>
      <td>99.445949</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2016-01-16</td>
      <td>15.0</td>
      <td>0.916631</td>
      <td>High</td>
      <td>100.782781</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2016-01-17</td>
      <td>16.0</td>
      <td>0.382247</td>
      <td>Medium</td>
      <td>111.466805</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2016-01-18</td>
      <td>17.0</td>
      <td>0.197341</td>
      <td>High</td>
      <td>81.139682</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2016-01-19</td>
      <td>18.0</td>
      <td>0.300417</td>
      <td>Medium</td>
      <td>111.079628</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2016-01-20</td>
      <td>19.0</td>
      <td>0.761067</td>
      <td>Medium</td>
      <td>92.171132</td>
    </tr>
  </tbody>
</table>
</div>




```python
#é‡ç½®è¡Œã€åˆ—ç´¢å¼•æ ‡ç­¾
df_reindexed = df.reindex(index=[0,2,5], columns=['A', 'C', 'B'])
df_reindexed
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>C</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016-01-01</td>
      <td>Low</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2016-01-03</td>
      <td>Low</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2016-01-06</td>
      <td>High</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



##  reindex_like() 

ç°æœ‰ aã€b ä¸¤ä¸ª DataFrame å¯¹è±¡ï¼Œå¦‚æœæƒ³è®© a  çš„è¡Œç´¢å¼•ä¸ b ç›¸åŒï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ reindex_like() æ–¹æ³•ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š


```python
a = pd.DataFrame(np.random.randn(10,3),columns=['col1','col2','col3'])
b = pd.DataFrame(np.random.randn(7,3),columns=['col1','col2','col3'])
```


```python
a= a.reindex_like(b)
print(a)

```

           col1      col2      col3
    0 -1.628672 -0.583674 -0.441093
    1  0.165955 -0.480662 -1.768928
    2  0.052035  0.499503  0.164273
    3  0.178304 -0.015302  0.175067
    4  1.011947  0.211428  1.564608
    5 -1.002858 -0.670168 -0.590156
    6  1.127713 -0.414167 -0.183754


ä¸Šè¿°ç¤ºä¾‹ï¼Œa ä¼šæŒ‰ç…§ b çš„å½¢å¼é‡å»ºè¡Œç´¢å¼•ã€‚éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œa ä¸ b çš„åˆ—ç´¢å¼•æ ‡ç­¾å¿…é¡»ç›¸åŒã€‚

### å¡«å……å…ƒç´ å€¼

reindex_like() æä¾›äº†ä¸€ä¸ªå¯é€‰çš„å‚æ•°**method**ï¼Œä½¿ç”¨å®ƒæ¥å¡«å……ç›¸åº”çš„å…ƒç´ å€¼ï¼Œå‚æ•°å€¼ä»‹ç»å¦‚ä¸‹ï¼š  
pad/ffillï¼šå‘å‰å¡«å……å€¼ï¼›  
bfill/backfillï¼šå‘åå¡«å……å€¼ï¼›  
nearestï¼šä»è·ç¦»æœ€è¿‘çš„ç´¢å¼•å€¼å¼€å§‹å¡«å……ã€‚  


```python
df1 = pd.DataFrame(np.random.randn(6,3),columns=['col1','col2','col3'])
df2 = pd.DataFrame(np.random.randn(2,3),columns=['col1','col2','col3'])
#ä½¿df2å’Œdf1è¡Œæ ‡ç­¾ç›¸åŒ
print("#å¡«å……å‰")
print(df2.reindex_like(df1))
#å‘å‰å¡«å……
print("#å¡«å……å")
print(df2.reindex_like(df1,method='ffill'))
```

    #å¡«å……å‰
           col1      col2      col3
    0 -0.374528  0.852631 -1.399773
    1  0.002027  0.490353  2.190524
    2       NaN       NaN       NaN
    3       NaN       NaN       NaN
    4       NaN       NaN       NaN
    5       NaN       NaN       NaN
    #å¡«å……å
           col1      col2      col3
    0 -0.374528  0.852631 -1.399773
    1  0.002027  0.490353  2.190524
    2  0.002027  0.490353  2.190524
    3  0.002027  0.490353  2.190524
    4  0.002027  0.490353  2.190524
    5  0.002027  0.490353  2.190524


### é™åˆ¶å¡«å……è¡Œæ•°

reindex_like() è¿˜æä¾›äº†ä¸€ä¸ªé¢å¤–å‚æ•° limitï¼Œè¯¥å‚æ•°ç”¨æ¥æ§åˆ¶å¡«å……çš„æœ€å¤§è¡Œæ•°ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š


```python
df1 = pd.DataFrame(np.random.randn(6,3),columns=['col1','col2','col3'])
df2 = pd.DataFrame(np.random.randn(2,3),columns=['col1','col2','col3'])
print("#å¡«å……å‰")
print (df2.reindex_like(df1))
#æœ€å¤šå¡«å……2è¡Œ
print("#å¡«å……å")
print (df2.reindex_like(df1,method='ffill',limit=2))
```

    #å¡«å……å‰
           col1      col2      col3
    0 -1.065744 -0.628913 -0.890608
    1 -0.868149  0.323155  0.592059
    2       NaN       NaN       NaN
    3       NaN       NaN       NaN
    4       NaN       NaN       NaN
    5       NaN       NaN       NaN
    #å¡«å……å
           col1      col2      col3
    0 -1.065744 -0.628913 -0.890608
    1 -0.868149  0.323155  0.592059
    2 -0.868149  0.323155  0.592059
    3 -0.868149  0.323155  0.592059
    4       NaN       NaN       NaN
    5       NaN       NaN       NaN


## rename() 

rename() æ–¹æ³•å…è®¸æ‚¨ä½¿ç”¨æŸäº›æ˜ å°„(dictæˆ–Series)æˆ–ä»»æ„å‡½æ•°æ¥å¯¹è¡Œã€åˆ—æ ‡ç­¾é‡æ–°å‘½åï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š


```python
df1 = pd.DataFrame(np.random.randn(6,3),columns=['col1','col2','col3'])
print("å‘½åå‰")
print (df1)
#å¯¹è¡Œå’Œåˆ—é‡æ–°å‘½å
print("å‘½åå")
print (df1.rename(columns={'col1' : 'c1', 'col2' : 'c2'},index = {0 : 'apple', 1 : 'banana', 2 : 'durian'}))
```

    å‘½åå‰
           col1      col2      col3
    0 -1.742492  0.345284  0.689351
    1 -0.296505  0.359762  0.193635
    2  1.780848 -1.577495 -0.523360
    3  0.511229 -0.147474  0.284064
    4 -0.627686 -1.270925  1.444171
    5  0.420444 -1.219966 -1.664974
    å‘½åå
                  c1        c2      col3
    apple  -1.742492  0.345284  0.689351
    banana -0.296505  0.359762  0.193635
    durian  1.780848 -1.577495 -0.523360
    3       0.511229 -0.147474  0.284064
    4      -0.627686 -1.270925  1.444171
    5       0.420444 -1.219966 -1.664974


# Pandas iterationéå†

åœ¨ Pandas ä¸­åŒæ ·ä¹Ÿæ˜¯ä½¿ç”¨ for å¾ªç¯è¿›è¡Œéå†ã€‚é€šè¿‡foréå†åï¼ŒSeries å¯ç›´æ¥è·å–ç›¸åº”çš„ valueï¼Œè€Œ DataFrame åˆ™ä¼šè·å–**åˆ—æ ‡ç­¾**ã€‚ç¤ºä¾‹å¦‚ä¸‹


```python
N=20
df = pd.DataFrame({
   'A': pd.date_range(start='2016-01-01',periods=N,freq='D'),
   'x': np.linspace(0,stop=N-1,num=N),
   'y': np.random.rand(N),
   'C': np.random.choice(['Low','Medium','High'],N).tolist(),
   'D': np.random.normal(100, 10, size=(N)).tolist()
   })
print(df)

```

                A     x         y       C           D
    0  2016-01-01   0.0  0.309422    High  105.842396
    1  2016-01-02   1.0  0.287303  Medium  102.596000
    2  2016-01-03   2.0  0.351692     Low  102.683707
    3  2016-01-04   3.0  0.715536     Low   96.667884
    4  2016-01-05   4.0  0.323528     Low  102.065947
    5  2016-01-06   5.0  0.611588  Medium   97.882380
    6  2016-01-07   6.0  0.242535     Low   99.169613
    7  2016-01-08   7.0  0.577218  Medium  105.902458
    8  2016-01-09   8.0  0.269061     Low   92.299404
    9  2016-01-10   9.0  0.708889    High   92.956118
    10 2016-01-11  10.0  0.058634  Medium   86.844656
    11 2016-01-12  11.0  0.605411    High   87.704475
    12 2016-01-13  12.0  0.078466    High  101.054271
    13 2016-01-14  13.0  0.658722    High   85.400332
    14 2016-01-15  14.0  0.381965     Low   97.605393
    15 2016-01-16  15.0  0.505028  Medium  113.053962
    16 2016-01-17  16.0  0.815197    High  106.798395
    17 2016-01-18  17.0  0.995368     Low   90.806364
    18 2016-01-19  18.0  0.120795  Medium  103.408369
    19 2016-01-20  19.0  0.327199    High  135.356433



```python
for col in df:
    print (col)
```

    A
    x
    y
    C
    D


## å†…ç½®è¿­ä»£æ–¹æ³•

å¦‚æœæƒ³è¦éå† DataFrame çš„æ¯ä¸€è¡Œï¼Œæˆ‘ä»¬ä¸‹åˆ—å‡½æ•°ï¼š
1) iteritems()ï¼šä»¥é”®å€¼å¯¹ (key,value) çš„å½¢å¼éå†ï¼›  
2) iterrows()ï¼šä»¥ (row_index,row) çš„å½¢å¼éå†è¡Œ;   
3) itertuples()ï¼šä½¿ç”¨å·²å‘½åå…ƒç»„çš„æ–¹å¼å¯¹è¡Œéå†ã€‚


### iteritems()

ä»¥é”®å€¼å¯¹çš„å½¢å¼éå† DataFrame å¯¹è±¡ï¼Œä»¥åˆ—æ ‡ç­¾ä¸ºé”®ï¼Œä»¥å¯¹åº”åˆ—çš„å…ƒç´ ä¸ºå€¼ã€‚


```python
df = pd.DataFrame(np.random.randn(4,3),columns=['col1','col2','col3'])
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col1</th>
      <th>col2</th>
      <th>col3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.179303</td>
      <td>0.536200</td>
      <td>0.259813</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.730208</td>
      <td>-1.200034</td>
      <td>-1.100648</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.946189</td>
      <td>-1.478875</td>
      <td>-0.587366</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.020445</td>
      <td>0.255881</td>
      <td>-0.799191</td>
    </tr>
  </tbody>
</table>
</div>




```python
for key,value in df.iteritems():
    print (key,value)
```

    col1 0    0.179303
    1   -0.730208
    2   -0.946189
    3    1.020445
    Name: col1, dtype: float64
    col2 0    0.536200
    1   -1.200034
    2   -1.478875
    3    0.255881
    Name: col2, dtype: float64
    col3 0    0.259813
    1   -1.100648
    2   -0.587366
    3   -0.799191
    Name: col3, dtype: float64


    /tmp/ipykernel_2884594/225348054.py:1: FutureWarning: iteritems is deprecated and will be removed in a future version. Use .items instead.
      for key,value in df.iteritems():


### iterrows()

è¯¥æ–¹æ³•æŒ‰è¡Œéå†ï¼Œè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œä»¥è¡Œç´¢å¼•æ ‡ç­¾ä¸ºé”®ï¼Œä»¥æ¯ä¸€è¡Œæ•°æ®ä¸ºå€¼ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š


```python
for row_index,row in df.iterrows():
    print (row_index,row)
```

    0 col1    0.179303
    col2    0.536200
    col3    0.259813
    Name: 0, dtype: float64
    1 col1   -0.730208
    col2   -1.200034
    col3   -1.100648
    Name: 1, dtype: float64
    2 col1   -0.946189
    col2   -1.478875
    col3   -0.587366
    Name: 2, dtype: float64
    3 col1    1.020445
    col2    0.255881
    col3   -0.799191
    Name: 3, dtype: float64


### itertuples()

itertuples() åŒæ ·å°†è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¯¥æ–¹æ³•ä¼šæŠŠ DataFrame çš„æ¯ä¸€è¡Œç”Ÿæˆä¸€ä¸ªå…ƒç»„ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š


```python
for row in df.itertuples():
    print(row)
```

    Pandas(Index=0, col1=0.17930285451251501, col2=0.5361995229504988, col3=0.25981254861413866)
    Pandas(Index=1, col1=-0.7302079707854569, col2=-1.200033803486064, col3=-1.1006482553793395)
    Pandas(Index=2, col1=-0.9461890560037862, col2=-1.478874967811546, col3=-0.5873663693797115)
    Pandas(Index=3, col1=1.0204445533871827, col2=0.25588127211650025, col3=-0.7991909264093302)


## è¿­ä»£è¿”å›å‰¯æœ¬

è¿­ä»£å™¨è¿”å›çš„æ˜¯åŸå¯¹è±¡çš„å‰¯æœ¬ï¼Œæ‰€ä»¥ï¼Œå¦‚æœåœ¨è¿­ä»£è¿‡ç¨‹ä¸­ä¿®æ”¹å…ƒç´ å€¼ï¼Œä¸ä¼šå½±å“åŸå¯¹è±¡


```python
df = pd.DataFrame(np.random.randn(3,3),columns = ['col1','col2','col3'])
for index, row in df.iterrows():
    #å‡è®¾è¯´æˆ‘ä»¬è¦å°†å…¶å¢åŠ ä¸€åˆ—
    row['a'] = 15 
print (df)
#å‘ç°åŸæ¥çš„dfæ²¡æœ‰æ”¹å˜
```

           col1      col2      col3
    0 -1.065696  1.325678 -1.170486
    1 -0.714478  0.549454  0.671538
    2 -0.082885 -1.518229  0.302107


# Pandas sortingæ’åº

## æŒ‰æ ‡ç­¾æ’åº

ä½¿ç”¨ **sort_index()** æ–¹æ³•å¯¹è¡Œæ ‡ç­¾æ’åºï¼ŒæŒ‡å®šè½´å‚æ•°ï¼ˆaxisï¼‰æˆ–è€…æ’åºé¡ºåºã€‚æˆ–è€…å¯ä»¥å¯¹ DataFrame è¿›è¡Œæ’åºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒæŒ‰ç…§è¡Œæ ‡ç­¾åºæ’åºã€‚


```python
#è¡Œæ ‡ç­¾ä¹±åºæ’åˆ—ï¼Œåˆ—æ ‡ç­¾ä¹±åºæ’åˆ—
unsorted_df=pd.DataFrame(np.random.randn(10,2),index=[1,6,4,2,3,5,9,8,0,7],columns=['col2','col1'])
print(unsorted_df)
```

           col2      col1
    1  1.526377  1.445458
    6  1.065364 -0.333095
    4 -0.213595  0.840036
    2 -0.314056  0.348687
    3  0.492836 -1.345225
    5 -0.347495  0.019047
    9  1.611026  0.196454
    8 -1.057069  0.733011
    0 -0.327377  0.661649
    7  0.403446  0.918134



```python
sorted_df=unsorted_df.sort_index()
print(sorted_df)
```

           col2      col1
    0 -0.327377  0.661649
    1  1.526377  1.445458
    2 -0.314056  0.348687
    3  0.492836 -1.345225
    4 -0.213595  0.840036
    5 -0.347495  0.019047
    6  1.065364 -0.333095
    7  0.403446  0.918134
    8 -1.057069  0.733011
    9  1.611026  0.196454


## æŒ‰åˆ—æ ‡ç­¾æ’åº

é€šè¿‡ç»™ axis è½´å‚æ•°ä¼ é€’ 0 æˆ– 1ï¼Œå¯ä»¥å¯¹åˆ—æ ‡ç­¾è¿›è¡Œæ’åºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œaxis=0 è¡¨ç¤ºæŒ‰è¡Œæ’åºï¼›è€Œ axis=1 åˆ™è¡¨ç¤ºæŒ‰åˆ—æ’åºã€‚


```python
sorted_df=unsorted_df.sort_index(axis=1)
print (sorted_df)
```

           col1      col2
    1  1.445458  1.526377
    6 -0.333095  1.065364
    4  0.840036 -0.213595
    2  0.348687 -0.314056
    3 -1.345225  0.492836
    5  0.019047 -0.347495
    9  0.196454  1.611026
    8  0.733011 -1.057069
    0  0.661649 -0.327377
    7  0.918134  0.403446


## æŒ‰å€¼æ’åº

ä¸æ ‡ç­¾æ’åºç±»ä¼¼ï¼Œ**sort_values()** è¡¨ç¤ºæŒ‰å€¼æ’åºã€‚å®ƒæ¥å—ä¸€ä¸ªbyå‚æ•°ï¼Œè¯¥å‚æ•°å€¼æ˜¯è¦æ’åºæ•°åˆ—çš„  DataFrame åˆ—åã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š


```python
unsorted_df = pd.DataFrame({'col1':[2,1,1,1],'col2':[1,3,2,4]})
sorted_df = unsorted_df.sort_values(by='col1')
print (sorted_df)
```

       col1  col2
    1     1     3
    2     1     2
    3     1     4
    0     2     1


# Pandaså»é‡å‡½æ•°ï¼šdrop_duplicates()


```python
data={
   
    'A':[1,0,1,1],
    'B':[0,2,5,0],
    'C':[4,0,4,4],
    'D':[1,0,1,1]
}
df=pd.DataFrame(data=data)
print(df)
```

       A  B  C  D
    0  1  0  4  1
    1  0  2  0  0
    2  1  5  4  1
    3  1  0  4  1



```python
df.drop_duplicates()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>5</td>
      <td>4</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



å‘ç°æœ€åä¸€è¡Œè¢«å»æ‰äº†

# Pandaså¤„ç†å­—ç¬¦ä¸²

å¸¸ç”¨çš„å­—ç¬¦ä¸²å¤„ç†å‡½æ•°å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š


| å‡½æ•°åç§°                 |                            å‡½æ•°åŠŸèƒ½å’Œæè¿°                             | 
| :--------------------------: | :---------------------: |
| lower()                                   | å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™                                                      |   
| upper()                                   | å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™                                                      |   
| len()                                     | å¾—å‡ºå­—ç¬¦ä¸²çš„é•¿åº¦                                                        |   
| strip()                                   | å»é™¤å­—ç¬¦ä¸²ä¸¤è¾¹çš„ç©ºæ ¼(åŒ…å«æ¢è¡Œç¬¦                                         |   
| split()                                   | ç”¨æŒ‡å®šçš„åˆ†å‰²ç¬¦åˆ†å‰²å­—ç¬¦ä¸²                                                |   
| cat(sep="") |                                        ç”¨ç»™å®šçš„åˆ†éš”ç¬¦è¿æ¥å­—ç¬¦ä¸²å…ƒç´                                   |   
| get_dummies()                             | è¿”å›ä¸€ä¸ªå¸¦æœ‰ç‹¬çƒ­ç¼–ç å€¼çš„Data Frameç»“æ„                                  |   
| contains(pattern)                         | å¦‚æœå­å­—ç¬¦ä¸²åŒ…å«åœ¨å…ƒç´ ä¸­ï¼Œ åˆ™ä¸ºæ¯ä¸ªå…ƒç´ è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼Trueï¼Œ å¦åˆ™ä¸ºFalse |   
| replace(a,b)              |                       å°†å€¼aæ›¿æ¢ä¸ºå€¼b                                                   |  
| count(pattern)                            | è¿”å›æ¯ä¸ªå­—ç¬¦ä¸²å…ƒç´ å‡ºç°çš„æ¬¡æ•°                                            |  
| startswith(pattern)                       | å¦‚æœSeriesä¸­çš„å…ƒç´ ä»¥æŒ‡å®šçš„å­—ç¬¦ä¸²å¼€å¤´ï¼Œ åˆ™è¿”å›True                       |   
| endswith(pattern)                         | å¦‚æœSeriesä¸­çš„å…ƒç´ ä»¥æŒ‡å®šçš„å­—ç¬¦ä¸²ç»“å°¾ï¼Œ åˆ™è¿”å›True                       |   
| findall(pattern)                          | ä»¥åˆ—è¡¨çš„å½¢å¼è¿”å‡ºç°çš„å­—ç¬¦ä¸²                                              |   
| swapcase()                                | äº¤æ¢å¤§å°å†™                                                              |   
| islower()                                 | è¿”å›å¸ƒå°”å€¼ï¼Œ æ£€æŸ¥Seriesä¸­ç»„æˆæ¯ä¸ªå­—ç¬¦ä¸²çš„æ‰€æœ‰å­—ç¬¦æ˜¯å¦éƒ½ä¸ºå°å†™           |   
| issupper()                                | è¿”å›å¸ƒå°”å€¼ï¼Œ æ£€æŸ¥Seriesä¸­ç»„æˆæ¯ä¸ªå­—ç¬¦ä¸²çš„æ‰€æœ‰å­—ç¬¦æ˜¯å¦éƒ½ä¸ºå¤§å†™           |   
| isnumeric()                               | è¿”å›å¸ƒå°”å€¼ï¼Œ æ£€æŸ¥Seriesä¸­ç»„æˆæ¯ä¸ªå­—ç¬¦ä¸²çš„æ‰€æœ‰å­—ç¬¦æ˜¯å¦éƒ½ä¸ºæ•°å­—           |   
| repeat(value)                             | ä»¥æŒ‡å®šçš„æ¬¡æ•°é‡å¤æ¯ä¸ªå…ƒç´                                                 |   
| find(pattern)                             | è¿”å›å­—ç¬¦ä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®                                          |   

è¿™é‡Œæˆ‘ä»¬è®²è§£å‡ ä¸ªè¾ƒä¸ºå¸¸ç”¨çš„å‡½æ•°ï¼š

## len()

 len()å¾—å‡ºå­—ç¬¦ä¸²çš„é•¿åº¦ã€‚


```python
s = pd.Series(['C', 'Python', 'java', 'go', np.nan, '1125','javascript'])
print(s.str.len())
```

    0     1.0
    1     6.0
    2     4.0
    3     2.0
    4     NaN
    5     4.0
    6    10.0
    dtype: float64


## split()

ç”¨æŒ‡å®šçš„åˆ†å‰²ç¬¦åˆ†å‰²å­—ç¬¦ä¸²ã€‚


```python
s = pd.Series(['C ',' Python','java','go','1125 ','javascript'])
print(s.str.split(" "))
```

    0           [C, ]
    1      [, Python]
    2          [java]
    3            [go]
    4        [1125, ]
    5    [javascript]
    dtype: object


## cat(sep="")

ç”¨ç»™å®šçš„åˆ†éš”ç¬¦è¿æ¥å­—ç¬¦ä¸²å…ƒç´ ã€‚


```python
s = pd.Series(['C', 'Python', 'java', 'go', np.nan, '1125','javascript'])
#ä¼šè‡ªåŠ¨å¿½ç•¥NaN
print(s.str.cat(sep="_"))
```

    C_Python_java_go_1125_javascript


## get_dummies()

è¿”å›ä¸€ä¸ªå¸¦æœ‰ç‹¬çƒ­ç¼–ç å€¼çš„ DataFrame ç»“æ„ã€‚


```python
s = pd.Series(['C', 'Python', 'java', 'go', np.nan, '1125','javascript'])
print(s.str.get_dummies())
```

       1125  C  Python  go  java  javascript
    0     0  1       0   0     0           0
    1     0  0       1   0     0           0
    2     0  0       0   0     1           0
    3     0  0       0   1     0           0
    4     0  0       0   0     0           0
    5     1  0       0   0     0           0
    6     0  0       0   0     0           1

